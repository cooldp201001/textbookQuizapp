//questions
const pipesAndCisternsQues = [
  {
    "quesNo": 1,
    "answer": "13.5 minutes",
    "options": [
      "12 minutes",
      "13.5 minutes",
      "15 mintes",
      "14.5 minutes"
    ],
    "question": "Pipe A and Pipe B can fill a tank in 20 minutes and 30 minutes respectively. Pipe C can empty the tank in 60 minutes.  The tank is initially empty. Both the pipes A and B are opened. Pipe C is opened after 6 minutes. How much time does it take to fill the tank?",
  },
  {
    "quesNo": 2,
    "answer": "12",
    "options": [
      "12",
      "15",
      "20",
      "18"
    ],
    "question": "Pipe A and Pipe B can fill a tank in 20 minutes and 10 minutes respectively. Pipe C can empty the tank in 15 minutes.  If the three pipes are opened simultaneously, find the time taken to fill the tank.",
  },
  {
    "quesNo": 3,
    "answer": "3.5 liters",
    "options": [
      "7 liters",
      "5 liters",
      "3.5 liters",
      "2.5 liters"
    ],
    "question": "Pipes P and Q can empty a tank in 1 hr and 1.5 hrs respectively. Pipes R and S can fill a tank in 2 hrs and 2.5 hrs respectively. The tank is filled to its capacity of 15 liters and all four pipes are opened simultaneously. How much water remains in the tank after an hour? ",
  },
  {
    "quesNo": 4,
    "answer": "167 minutes",
    "options": [
      "180 minutes",
      "167 minutes",
      "200 minutes",
      "178 minutes"
    ],
    "question": "Three pipes, A, B, & C are attached to a tank. A & B can fill it in 20 & 30 minutes respectively while C can empty it in 15 minutes. If A, B & C are kept open successively for 1 minute each, how soon will the tank be filled?",
  },
  {
    "quesNo": 5,
    "answer": "40 minutes",
    "options": [
      "30 minutes",
      "45 minutes",
      "40 minutes",
      "25 minutes"
    ],
    "question": "Pipe A and Pipe B can fill a tank in 1 hour and 1 Â¼ hours respectively. Both pipes are opened in the beginning and after some time, pipe B is closed. The tank is filled in 40 minutes. Pipe B was closed after",
  },
  {
    "quesNo": 6,
    "answer": "30 minutes",
    "options": [
      "60 minutes",
      "40 minutes",
      "30 minutes",
      "20 minutes"
    ],
    "question": "Two pipes A and B can fill a tank in 20 minutes when opened simultaneously. If pipe A alone takes 60 minutes to fill the tank, how much time will pipe B alone take to fill the tank?",
  },
  {
    "quesNo": 7,
    "answer": "7 hours",
    "options": [
      "10 minutes",
      "7/6 hours",
      "6/7 hours",
      "7 hours"
    ],
    "question": "A pipe can fill a tank in an hour. Because of a leak, it took 1 hour and 10 minutes to fill the tank. Find the time taken by the leak to drain all the water in the tank.",
  },
  {
    "quesNo": 8,
    "answer": "12 minutes",
    "options": [
      "6 minutes",
      "12 minutes",
      "12.5 minutes",
      "24 minutes"
    ],
    "question": "Two taps A and B can fill a bathtub in 10 minutes and 15 minutes respectively. If A was open for the first two minutes, B for the next two minutes and so on, the bathtub is filled in",
  },
  {
    "quesNo": 9,
    "answer": "7 minutes",
    "options": [
      "7 minutes",
      "14 minutes",
      "3.5 minutes",
      "28 minutes"
    ],
    "question": "A tank has three inlets A, B and C. C takes twice the time taken by A to fill the tank and B takes half the time taken by A to fill the tank. If they can fill the tank together in 4 minutes, find the time taken by B to fill the tank.",
  },
  {
    "quesNo": 10,
    "answer": "30 minutes",
    "options": [
      "60 minutes",
      "40 minutes",
      "30 minutes",
      "20 minutes"
    ],
    "question": "Two pipes A and B can fill a tank in 20 minutes when opened simultaneously. If pipe A alone takes 60 minutes to fill the tank, how much time will pipe B alone take to fill the tank?",
  }
]
const probabilityQues = [

  {
    "quesNo": 1,
    "answer": "19/66",
    "options": [
      "5/33",
      "2/11",
      "19/66",
      "38/66"
    ],
    "question": "A bag contains 5 red balls, 3 blue balls and 4 green balls. Two balls are drawn out at random. Find the probabilityCat that they will be of the same colour.",
  },
  {
    "quesNo": 2,
    "answer": "8/663",
    "options": [
      "5/1326",
      "2/663",
      "8/1326",
      "8/663"
    ],
    "question": "From an ordinary pack of cards, two cards are drawn out at random. Find the probabilityCat that they consist of a king and a queen.",
  },
  {
    "quesNo": 3,
    "answer": "5/36",
    "options": [
      "5/18",
      "1/6",
      "5/36",
      "7/36"
    ],
    "question": "A and B throw a dice. Find the probabilityCat that the sum of their throws is 6.",
  },
  {
    "quesNo": 4,
    "answer": "5/8",
    "options": [
      "1/4",
      "5/8",
      "3/8",
      "3/4"
    ],
    "question": "Three coins are tossed. Find the probabilityCat of getting two heads and a tail.",
  },
  {
    "quesNo": 5,
    "answer": "1/16",
    "options": [
      "1/4",
      "1/32",
      "1/16",
      "1/5"
    ],
    "question": "Out of 5 children, the eldest is a girl. Find the probabilityCat that the rest are boys.",
  },
  {
    "quesNo": 6,
    "answer": "1/4",
    "options": [
      "1/4",
      "2/9",
      "1/6",
      "1/5"
    ],
    "question": "Two dice are thrown simultaneously. Find the probabilityCat of getting a prime number on both the dice.",
  },
  {
    "quesNo": 7,
    "answer": "4/13",
    "options": [
      "2/13",
      "1/13",
      "4/13",
      "3/13"
    ],
    "question": "A card is drawn at random from a pack of well-shuffled cards. What is the probabilityCat that the card is a face card?",
  },
  {
    "quesNo": 8,
    "answer": "7/8",
    "options": [
      "1/8",
      "7/8",
      "5/8",
      "3/4"
    ],
    "question": "What is the probabilityCat of getting at most two tails in tossing three fair coins?",
  },
  {
    "quesNo": 9,
    "answer": "17/42",
    "options": [
      "17/42",
      "5/42",
      "15/42",
      "7/42"
    ],
    "question": "Three balls are drawn out at random from a bag containing 4 red balls and 5 yellow balls. What is the probabilityCat of getting at least two red balls?",
  },
  {
    "quesNo": 10,
    "answer": "1/3",
    "options": [
      "1/2",
      "1/3",
      "1/4",
      "1/6"
    ],
    "question": "Two fair dice are thrown. What is the probabilityCat of getting a sum that is a multiple of 3?",
  }
]
const profitAndLossQues = [
  {
    "quesNo": 1,
    "answer": "Rs.240",
    "options": [
      "Rs.200",
      "Rs.220",
      "Rs.240",
      "Rs.250"
    ],
    "question": "A shopkeeper sells 1 kg of apples for Rs. 160 at a loss of 20%. At what price should he sell a kg of apples to gain 20%?",
  },
  {
    "quesNo": 2,
    "answer": "20%",
    "options": [
      "10%",
      "5%",
      "20%",
      "12%"
    ],
    "question": "I bought 10 pencils for Rs.50 and sold them for Rs.60. What is my gain %?",
  },
  {
    "quesNo": 3,
    "answer": "50%",
    "options": [
      "25%",
      "40%",
      "50%",
      "60%"
    ],
    "question": "A man sells an article at a profit of 20%. If he had bought it for 20% less but sells at the same price, find the gain %.",
  },
  {
    "quesNo": 4,
    "answer": "5(5/19)%",
    "options": [
      "5%",
      "5(5/19)%",
      "4(5/19)%",
      "5(10/19)%"
    ],
    "question": "A shopkeeper sells his goods at the cost price but uses a false weight of 950 gm. Find his gain %.",
  },
  {
    "quesNo": 5,
    "answer": "12.5%",
    "options": [
      "20%",
      "15%",
      "12.5%",
      "10%"
    ],
    "question": "A shopkeeper sells a bag at a gain of 25%. He offers a discount of 10% on the bag. What is his profit %?",
  },
  {
    "quesNo": 6,
    "answer": "Rs.16",
    "options": [
      "Rs.16",
      "Rs.18",
      "Rs.10",
      "Rs.8"
    ],
    "question": "A man bought 10 apples and 8 oranges for Rs.200 and sold them for Rs.212. If he gained 12.5% on the apples and lost 20% on the oranges. Find the cost of an apple.",
  },
  {
    "quesNo": 7,
    "answer": "10%",
    "options": [
      "25%",
      "20%",
      "15%",
      "10%"
    ],
    "question": "John buys a second-hand car for Rs.1,80,000 and spent Rs.20,000 for repairing it. He sold it for Rs.2,20000. Find his gain %.",
  },
  {
    "quesNo": 8,
    "answer": "15%",
    "options": [
      "5%",
      "10%",
      "15%",
      "25%"
    ],
    "question": "12 articles were sold at the cost price of 15 articles. Find the profit %.",
  },
  {
    "quesNo": 9,
    "answer": "100%",
    "options": [
      "100%",
      "75%",
      "50%",
      "25%"
    ],
    "question": "The gain triples when the selling price of an item is doubled. Find the gain %.",
  },
  {
    "quesNo": 10,
    "answer": "Rs.21",
    "options": [
      "Rs.20",
      "Rs.21",
      "Rs.24",
      "Rs.25"
    ],
    "question": "A shopkeeper bought 60 apples at the rate of Rs.240 per dozen. For how much should he sell an apple in order to gain 5%?",
  }
]
const problemsonAgesQues = [
  {
    "quesNo": 1,
    "answer": "6",
    "options": [
      "2",
      "4",
      "6",
      "8"
    ],
    "question": "The ratio of the ages of A and B is 2:3. If B is 3 years elder than A, find the age of A after 2 years.",
  },
  {
    "quesNo": 2,
    "answer": "8",
    "options": [
      "14",
      "12",
      "8",
      "6"
    ],
    "question": "Two years ago, Harish was thrice as old as his brother Krish. Two years later, Harish will be twice as old as Krish. Find the present age of Krish.",
  },
  {
    "quesNo": 3,
    "answer": "4",
    "options": [
      "4",
      "6",
      "8",
      "2"
    ],
    "question": "In a family of four, the average age is 20. The parents' age difference is 6 and the siblings' age difference is 4. If the ages of the eldest and youngest member differ by 33, find the age of the youngest member of the family.",
  },
  {
    "quesNo": 4,
    "answer": "20",
    "options": [
      "25",
      "20",
      "15",
      "16"
    ],
    "question": "Ram is 5 years elder than Lakshman who is 4 years elder than Bharath. The sum of their ages is 61. Find the age of Lakshman.",
  },
  {
    "quesNo": 5,
    "answer": "33",
    "options": [
      "27",
      "30",
      "33",
      "36"
    ],
    "question": "The sum of the ages of a mother and a son is equal to the age of the father. Three years later, the father will be six times as old as his son. The ratio of the present ages of the mother and son is 10:1. Find the age of the father.",
  },
  {
    "quesNo": 6,
    "answer": "6",
    "options": [
      "6",
      "9",
      "11",
      "14"
    ],
    "question": "Ram and Raj are twins. The sum of their ages combined with their father's age is 47. Their father's age at the time of their birth was 29. Find the age of Ram.",
  },
  {
    "quesNo": 7,
    "answer": "46",
    "options": [
      "58",
      "46",
      "28",
      "24"
    ],
    "question": "Thirteen years back, my mother was thrice my age and two years back, she was twice my age. Find my mother's present age.",
  },
  {
    "quesNo": 8,
    "answer": "18",
    "options": [
      "18",
      "16",
      "11",
      "9"
    ],
    "question": "A man has three daughters. The present ages of all three of them are square numbers. The sum of their ages after 5 years is 41. Find the age of his eldest daughter after 2 years.",
  },
  {
    "quesNo": 9,
    "answer": "360",
    "options": [
      "360",
      "240",
      "120",
      "480"
    ],
    "question": "A wizard named Nepo says \"I am only three times my son's age. My father is 40 years more than twice my age. Together the three of us are a mere 1240 years old.\" How old is Nepo?",
  },
  {
    "quesNo": 10,
    "answer": "45",
    "options": [
      "36",
      "42",
      "45",
      "48"
    ],
    "question": "A father is three times as old as his son. After fifteen years the father will be twice as old as his son's age at that time. Hence the father's present age is",
  }
]

//variables
let regex = /^[a-zA-Z][ a-zA-Z_-]{2,19}$/gm;
const doc = document;
let userName;
let quesCount = 0;
let questionCountDis = 0;
let choosedCategory;
let clear;
let rightAns = 0;
let wrongAns = 0
let totalTimeTaken = 0;
let forwordCount = 0;

// home section elements
const homeSec = doc.querySelector(".homeSec");
const userNameInput = doc.querySelector("#userNameInput");
const enterBtn = doc.querySelector("#enterBtn");
const greetingAndErrorPara = doc.querySelector(".greetingAndErrorPara");
const categoryBtns = doc.querySelectorAll(".categoryBtns");
const pipesAndCisternsBtn = doc.querySelector("#pipesAndCisternsBtn");
const probabilityBtn = doc.querySelector("#probabilityBtn");
const problemOnAgesBtn = doc.querySelector("#problemOnAgesBtn");
const profitAndLossBtn = doc.querySelector("#profitAndLossBtn");

//quiz section elements
const quizSec = doc.querySelector(".quizSec");
const choosedCategoryHeading = doc.querySelector("#choosedCategoryHeading");
const timerDiv = doc.querySelector("#timerDiv");
const timer = doc.querySelector("#timer");
const score = doc.querySelector("#score");
const questionNo = doc.querySelector("#questionNo");
const question = doc.querySelector("#question");
// buttons elements
const optBtns = doc.querySelectorAll(".optBtns");
const opt1Btn = doc.querySelector("#opt1Btn");
const opt2Btn = doc.querySelector("#opt2Btn");
const opt3Btn = doc.querySelector("#opt3Btn");
const opt4Btn = doc.querySelector("#opt4Btn");
const nextBtn = doc.querySelector("#nextBtn");
const showResultBtn = doc.querySelector("#showResultBtn");

//result Section elements assessing
const resultSec = doc.querySelector('.resultSec');
const userNameShow = doc.querySelector('#userNameShow');
const timeTaknen = doc.querySelector('#timeTaken');
const attempt = doc.querySelector('#attempt');
const totalCorrectAns = doc.querySelector('#totalCorrectAns');
const totalwrongAns = doc.querySelector('#totalwrongAns');
const percentage = doc.querySelector('#percentage');
const startAgainBtn = doc.querySelector('#startAgainBtn');
const GoToHomeBtn = doc.querySelector('#GoToHomeBtn');

// event handlers
// username validation
enterBtn.onclick = () => {
  greetingAndErrorPara.style.visibility = "visible"
  //removing extra spaces
  userName = userNameInput.value.trim()
  let result = regex.test(userName);
  if (result) {
    userNameInput.blur()
    greetingAndErrorPara.innerHTML = `Hii ${userName}`;
    if (greetingAndErrorPara.classList.contains('errorMsg')) {
      greetingAndErrorPara.classList.remove("errorMsg");
    }
    greetingAndErrorPara.classList.add("greeting")
    categoryBtns.forEach(element => {
      element.removeAttribute("disabled")
    });

  }
  else {
    userNameInput.focus()
    greetingAndErrorPara.style.visibility = "visible"
    greetingAndErrorPara.innerHTML = "Invalid username!";
    greetingAndErrorPara.classList.remove("greeting");
    greetingAndErrorPara.classList.add("errorMsg")
    categoryBtns.forEach(element => {
      element.setAttribute("disabled", true)
    });
  }
  userNameInput.value = ""
};

// category buttons handlers
pipesAndCisternsBtn.onclick = (event) => {
  quizStructure(pipesAndCisternsQues);
  showChoosedCategoryHeading(event);
};
probabilityBtn.onclick = (event) => {
  quizStructure(probabilityQues);
  showChoosedCategoryHeading(event);
};
problemOnAgesBtn.onclick = (event) => {
  quizStructure(problemsonAgesQues);
  showChoosedCategoryHeading(event);
};
profitAndLossBtn.onclick = (event) => {
  quizStructure(profitAndLossQues);
  showChoosedCategoryHeading(event);
};

// next button
nextBtn.onclick = () => {
  totalTimeCal();
  clearInterval(clear);
  timerStart();
  questionUpdateFun();
  //removing the alert highlight color
  if (timerDiv.classList.contains('timeupAlert')) {
    timerDiv.classList.remove('timeupAlert');
  }
};

// options buttons
opt1Btn.onclick = () => {
  answerCheck(opt1Btn.innerHTML);
};
opt2Btn.onclick = () => {
  answerCheck(opt2Btn.innerHTML);
};
opt3Btn.onclick = () => {
  answerCheck(opt3Btn.innerHTML);
};
opt4Btn.onclick = () => {
  answerCheck(opt4Btn.innerHTML);
};

showResultBtn.onclick = () => {
  quizSec.style.display = "none"
  resultSec.style.display = "flex"
  showResult();
};

GoToHomeBtn.onclick = () => {
  location.reload();
};

startAgainBtn.onclick = () => {
  resultSec.style.display = "none";
  quizSec.style.display = "flex";
  // setting the values to default for start again with same user
  clearInterval(clear)
  quesCount = 0;
  rightAns = 0;
  wrongAns = 0;
  totalTimeTaken = 0;
  score.innerHTML = rightAns;
  showResultBtn.style.display = "none"
  nextBtn.style.display = "block";

  if (timerDiv.classList.contains('timeupAlert')) {
    timerDiv.classList.remove('timeupAlert');
  }
  quizStructure(choosedCategory);
};

// all function defination


//functoin definition
function hideHomeSec() {
  homeSec.style.display = "none"
  quizSec.style.display = "flex"
};

//quizStructure for giving category to quiz page
function quizStructure(category) {
  choosedCategory = category;
  hideHomeSec();
  timerStart();
  questionUpdateFun();
};

//function for updating the question and options
function questionUpdateFun() {
  // calling fun for removing the ans style
  removeAnsStyle();
  questionNo.innerHTML = choosedCategory[quesCount].quesNo;
  question.innerHTML = choosedCategory[quesCount].question
  let answers = choosedCategory[quesCount].options
  let optionCount = 0;
  optBtns.forEach((element) => {
    element.innerHTML = answers[optionCount]
    optionCount++;
  })
  ++quesCount;
  if (questionNo.innerHTML == 10) {
    toggleNextAndResultBtn();
  }
};

//function for starting the quiz timer
function timerStart() {
  let sec = 9;
  // setting initial value by setTimeout
  setTimeout(() => {
    timer.innerHTML = sec + 1
  }, 0)
  clear = setInterval(() => {
    if (sec >= 0) {
      timer.innerHTML = sec
      if (sec <= 3) {
        //adding the alert property into timer
        timerDiv.classList.add('timeupAlert');
      }
    }

    if (sec < 0) {
      clearInterval(clear);
      totalTimeCal();
      //removing the alert property from timer
      timerDiv.classList.remove('timeupAlert');

      if (quesCount < 10) {
        questionUpdateFun();
        timerStart();
      }
      //this is for last question disable the option after timer=0 & ques =10;
      if (quesCount == 10) {
        disableOptionBtns();
      }
    }
    --sec;
  }, 1000)
};

//fun for checking the answer after choosing the options
function answerCheck(choosedAnswer) {
  totalTimeCal();
  let quesCountdup = quesCount - 1;
  let correctAnswer = choosedCategory[quesCountdup].answer;

  // disable buttons after selecting the options
  optBtns.forEach((btn) => {
    btn.setAttribute('disabled', true)
  })

  if (choosedAnswer == correctAnswer) {
    //updating score
    rightAns++;
    score.innerHTML = rightAns;
    //adding style to the correct option
    optBtns.forEach((btn) => {
      if (choosedAnswer === btn.innerHTML) {
        btn.classList.add('correctAns')
      }
    })
  }
  else {
    wrongAns++;
    //adding style to the  wrong answer buttons
    optBtns.forEach((btn) => {
      if (choosedAnswer === btn.innerHTML) {
        btn.classList.add('wrongAns')
      }
      if (correctAnswer == btn.innerHTML) {
        btn.classList.add('correctAns')
      }
    })
  }
};

//remove ansStyles function
function removeAnsStyle() {
  optBtns.forEach((btn) => {
    btn.removeAttribute('disabled')
    if (btn.classList.contains('wrongAns')) {
      btn.classList.remove('wrongAns');
    }
    if (btn.classList.contains('correctAns')) {
      btn.classList.remove('correctAns');
    }
  })
};

//disable options buttons after selecting one of them
function disableOptionBtns() {
  optBtns.forEach((btn) => {
    btn.setAttribute('disabled', true)
  })
};

// function for next and show Result buttons
function toggleNextAndResultBtn() {
  nextBtn.style.display = "none";
  showResultBtn.style.display = "block";
};

//showResult function
function showResult() {
  userNameShow.innerHTML = userName;
  timeTaknen.innerHTML = totalTimeTaken;
  attempt.innerHTML = wrongAns + rightAns;
  totalCorrectAns.innerHTML = rightAns;
  totalwrongAns.innerHTML = wrongAns;
  percentage.innerHTML = rightAns / 10 * 100;
};

//function for calculating the total time taken
function totalTimeCal() {
  //stop timing after the selecting the option
  clearInterval(clear);
  forwordCount = 10 - timer.innerHTML;
  totalTimeTaken = totalTimeTaken + forwordCount;
};

//fun for provinding quiz heading at the top of the page
function showChoosedCategoryHeading(e) {
  choosedCategoryHeading.innerHTML = e.target.innerHTML
};

//reload the page  when page is resized
// window.onresize = () => {
//   alert('The webpage has been resized!');
//   //reloading the page
//   location.reload();
// };

// do action on switched to a different tab or minimized the window
doc.onvisibilitychange = () => {
  if (document.hidden) {
    alert('You changed the tab!');
  } else {
    //reloading the page
    location.reload();
  }
}


